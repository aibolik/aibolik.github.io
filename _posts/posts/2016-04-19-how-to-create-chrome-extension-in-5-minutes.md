---
layout:	post
title:	How To Create Chrome Extension In 5 Minutes
category: blog
---

_First of all_, what is a **Chrome Extension?** Let's look what [_Wikipedia says about it_][wikiext]{:target="_blank"}.

> Google Chrome Extensions are browser extensions that modify the Google Chrome browser. These extensions are written using web technologies like HTML, JavaScript, and CSS. Google Chrome Extensions are downloadable through the Chrome Web Store.

_To be shortly_, using familiar for us technologies as _HTML, JavaScript_ and _CSS_ we can make some changes to Chrome browser(modifying content of a page, add some useful functionality and etc.).

### What we will do

In this tutorial I will be creating simple Chrome Extension that tints to some opacity(that we set in settings) images that match our preferences. Here is what we will use

* [Yeoman Chrome Extension Generator][yeoman]{:target="_blank"}
* Atom(my favorite editor)

#### Step 0

In order to be able to debug and see your extensions, we need to enable developer mode in Chrome Extensions. Simple go to **_Windows -> Extensions_** and tick the **_Developer mode_** on. You can load extensions by choosing your extension folder, or they will be loaded automatically when you execute `gulp watch` in _Step 1_.

![Enable Developer Mode][devmode]

#### Step 1

Using [**this**][yeoman]{:target="_blank"} GitHub repo and the Docs provided there we generate chrome extension package. Here is shortly what we do:

```console
# Please make sure that `yo`, `gulp` and `bower` was installed on your system using this command:
npm install --global yo gulp bower

# Install the generator:
npm install -g generator-chrome-extension

# Make a new directory, and `cd` get into it:
mkdir image-tinter && cd $_

# Generate a new project
yo chrome-extension

# Transform updated source written by ES2015 (default option)
gulp babel

# or Using watch to update source continuously
gulp watch

# Make a production version extension
gulp build
```
---
Note that, when generating chrome-extension with yeoman, we need to choose Browser Action, as we modify browser content

#### Step 2

_After Step 1_, we will have proper project structure generated by Yeoman. The main project is in **app** directory of project. The main file is **manifest.json**. We will add these lines inside:

```json
"permissions": [
  "activeTab"
]
```

This permission gives us access to active tab in the browser. We don't need to modify other lines, since they are generated by yeoman.

#### Step 3

**Creating the view for our extension.** Here we work with the file **_popup.html_**, where the view of our extension is handled. This popup is shown when we click the icon of the extension. Since we are creating _Image Tinter_, we need simple form for preferences. We adjust width and height of images to _tint_, and the _opacity_ we want it to be. And add the _button_ to let the process start. Here is the main body of **_popup.html_**:

```html
<body style="min-width:250px">
    <h2 style="text-align:center">Settings</h2>

    <fieldset class="form-group">
      <label for="width">Width</label>
      <input type="text" class="form-control" id="width" placeholder="Width" value="40">
    </fieldset>

    <fieldset class="form-group">
      <label for="height">Height</label>
      <input type="text" class="form-control" id="height" placeholder="Height" value="40">
    </fieldset>

    <fieldset class="form-group">
      <label for="opacity">Opacity</label>
      <input type="text" class="form-control" id="opacity" placeholder="Opacity" value="50">
    </fieldset>

    <button style="width:100%;" class="btn btn-primary" id="tint">Tint</button>

    <script src="scripts/popup.js"></script>
  </body>
```
---
_Optional:_ I added _bootstrap.css_ to somehow enhance the view.

#### Step 3

Here comes the main logic. We modify the content of _**scripts/popup.js**_. This one is called every single time we open our click our extension. The logic is simple: when user clicks the button, all images those match our preferences are tinted. Steps:
1. Add Click listener to button
2. When click is caught, get parameters of _width, height and opacity_
3. Execute **JavaScript code** that will tint images.

Here it is:

```javascript
document.getElementById('tint').addEventListener('click', function(e) {
  var width = document.getElementById('width').value;
  var height = document.getElementById('height').value;
  var opacity = document.getElementById('opacity').value;

  var execCode = ' \
    var imgs = document.getElementsByTagName("img"); \
    for (var i = 0; i < imgs.length; i++) { \
        if (imgs[i].height > '+ height +' && \
            imgs[i].width > '+ width +') { \
              imgs[i].setAttribute("style", "opacity: ' + opacity / 100 +'"); \
        } \
    }';

 chrome.tabs.executeScript({
   code: execCode
 });
});
```
---
_Note that_ we execute Script separately - this is how code is executed through our extension.

#### Step 4

Enjoy the result. That's it!

![Screenshot of work][imgtinterscreenshot]

You can see the whole code in [**my GitHub repo**][githubrepo]{:target="_blank"}.

[wikiext]: https://en.wikipedia.org/wiki/Google_Chrome_extension
[yeoman]: https://github.com/yeoman/generator-chrome-extension
[imgtinter]: https://github.com/aibolik/img-tinter-chrome-extension
[devmode]: {{ site.baseurl }}/img/blog/developermode.png
[imgtinterscreenshot]: {{ site.baseurl }}/img/blog/imgtinter.png
[githubrepo]: https://github.com/aibolik/img-tinter-chrome-extension
